window.dlz=LZString?LZString.decompressFromEncodedURIComponent:()=>{console.error('LZString not found. add <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"><\/script> to your html');return""};class InputParser{constructor(defaultFromDictMode="horizontal"){this.parse=this.parse.bind(this);this.testString=this.testString.bind(this);this.parseString=this.parseString.bind(this);this.isDict=this.isDict.bind(this);this.defaultFromDictMode=defaultFromDictMode;this.fromData=this.fromData.bind(this);this.fromString=this.fromString.bind(this);this.fromSRC=this.fromSRC.bind(this);this.fromJSON=this.fromJSON.bind(this);this.fromCSV=this.fromCSV.bind(this);this.fromMarkdown=this.fromMarkdown.bind(this);this.fromDict=this.fromDict.bind(this);this.fromHeadersAndDict=this.fromHeadersAndDict.bind(this);this.fromHeadersAndListOfDicts=this.fromHeadersAndListOfDicts.bind(this);this.fromHeadersAndListOfLists=this.fromHeadersAndListOfLists.bind(this);this.fromListOfDicts=this.fromListOfDicts.bind(this);this.fromListOfLists=this.fromListOfLists.bind(this);this.fromHeaders=this.fromHeaders.bind(this)}isDict(v){return v!==undefined&&v instanceof Object&&!(v instanceof Array)}parse(data){if(!data){return[]}else if(data instanceof Object){return data}if(typeof data==="string"){if(data.startsWith("[")&&data.endsWith("]")||data.startsWith("{")&&data.endsWith("}")){return JSON.parse(data)}else{return data.split(",").map(x=>x.trim())}}}testString(data){return/,|\||\n|\[|\]|\{|\}|\//.test(data)}parseString(data){data=data.trim();if(!data){return""}if(!this.testString(data)){let newdata;try{newdata=dlz(data);if(this.testString(newdata)){return newdata}}catch(e){}try{newdata=atob(data);if(this.testString(newdata)){return newdata}}catch(e){throw new Error("unable to interpret string")}}data=data.trim();return data}fromSRC(src){src=this.parseString(src);return fetch(src).then(r=>r.text()).then(t=>this.fromString(t))}fromData(headers,data){if(!headers&&!data){return[[],[]]}headers=this.parse(headers);data=this.parse(data);console.log("setData",headers,data);if(headers&&headers.length>0){if(this.isDict(data)){return this.fromHeadersAndDict(headers,data)}else if(data instanceof Array){if(data.every(x=>x instanceof Array)){return this.fromHeadersAndListOfLists(headers,data)}else if(data.every(x=>x instanceof Object)){return this.fromHeadersAndListOfDicts(headers,data)}}else{throw new Error("Data is not a dict, list of lists or a list of dicts")}}else{if(this.isDict(data)){return this.fromDict(data)}else if(data instanceof Array){if(data.every(x=>x instanceof Array)){return this.fromListOfLists(data)}else if(data.every(x=>x instanceof Object)){return this.fromListOfDicts(data)}}else{throw new Error("Data is not a dict, list of lists or a list of dicts")}}return[headers,data]}fromString(data){data=this.parseString(data);console.log("fromString",data);if(this.testString(data)){if(data.startsWith("[")&&data.endsWith("]")||data.startsWith("{")&&data.endsWith("}")){return this.fromJSON(data)}else if(data.startsWith("|")&&data.endsWith("|")){return this.fromMarkdown(data)}else if(data.startsWith("<")&&data.endsWith(">")){return this.fromHTML(data)}else{return this.fromCSV(data)}}else{throw new Error("unable to interpret string")}}fromJSON(json){return this.fromData(undefined,json)}fromCSV(csv){csv=this.parseString(csv);console.log("from csv",csv);let rows=csv.split("\n");console.log("rows",rows);rows=rows.filter(row=>row.trim());rows=rows.map(row=>{const cells=row.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);return cells.map(cell=>{return cell.trim().replace(/^"|"$/g,"")})});let headers=rows[0];let data=rows.slice(1);let numCols=headers.length;if(!data.every(row=>row.length===numCols)){throw new Error("Number of columns in data does not match number of columns in headers")}return this.fromHeadersAndListOfLists(headers,data)}fromMarkdown(md){md=this.parseString(md);console.log("from markdown",md);let rows=md.trim().split("\n").map(row=>row.trim());rows=rows.filter((row,index)=>index!==1);let parsedRows=rows.map(row=>{row=row.replace(/\\\|/g,"\0");let cells=row.split("|").map(cell=>cell.trim());cells=cells.map(cell=>cell.replace(/\0/g,"|").trim());return cells.filter(cell=>cell)});let headers=parsedRows[0];let data=parsedRows.slice(1);let numCols=headers.length;if(!data.every(row=>row.length===numCols)){throw new Error("Number of columns in data does not match number of columns in headers")}return this.fromHeadersAndListOfLists(headers,data)}fromHTML(html){if(!html.startsWith("<table>")){html=`<table>${html}</table>`}console.log("from html",html);let parser=new DOMParser;let doc=parser.parseFromString(html,"text/html");let table=doc.querySelector("table");const tableData=[];const parseSection=section=>{section.querySelectorAll("tr").forEach(row=>{const rowData=[];row.querySelectorAll("th, td").forEach(cell=>{rowData.push(cell.textContent||cell.innerText)});tableData.push(rowData)})};const sections=table.querySelectorAll("thead, tbody, tfoot");if(sections.length){sections.forEach(section=>parseSection(section))}else{parseSection(table)}let headers=tableData[0];let data=tableData.slice(1);return this.fromHeadersAndListOfLists(headers,data)}fromHeaders(headers){headers=this.parse(headers);console.log("from headers",headers);return[headers,[]]}fromHeadersAndDict(headers,data){headers=this.parse(headers);data=this.parse(data);console.log("from headers and dict",headers,data);return this.fromHeadersAndListOfDicts(headers,[data])}fromDict(data,mode){mode=mode||this.defaultFromDictMode;data=this.parse(data);let values=Array.from(Object.values(data));if(values.every(x=>x instanceof Array)){let headers=Array.from(Object.keys(data));let i=0;let numRows=data[headers[0]].length;if(!values.every(x=>x.length===numRows)){throw new Error("Number of rows in data does not match number of rows in headers")}let newdata=[];for(i=0;i<numRows;i++){let row=[];for(let header of headers){row.push(data[header][i])}newdata.push(row)}return this.fromHeadersAndListOfLists(headers,newdata)}else if(values.every(this.isDict)){let keyIsValueInEveryDict=true;for(let[k,v]of Object.entries(data)){if(!Object.keys(v).includes(k)){return false}}if(keyIsValueInEveryDict){return this.fromListOfDicts(values)}let headers=[];for(let row of values){for(let key in row){if(!headers.includes(key)){headers.push(key)}}}let keyNameChoices=["name","id","key","pk"];let keyName=keyNameChoices.find(x=>!headers.includes(x));let newValues=[];for(let[k,v]of Object.entries(data)){v[keyName]=k;newValues.push(v)}return this.fromListOfDicts(newValues)}if(mode==="horizontal"){console.log("from dict (horizontal)",data);let headers=Object.keys(data);data=[Array.from(Object.values(data))];return[headers,data]}else if(mode==="vertical"){console.log("from dict (vertical)",data);let headers=["key","value"];data=Object.entries(data);return[headers,data]}}fromHeadersAndListOfDicts(headers,data){data=this.parse(data);console.log("from headers and list of dicts",headers,data);return[headers,data]}fromHeadersAndListOfLists(headers,data){data=this.parse(data);console.log("from headers and list of lists",headers,data);return[headers,data]}fromListOfDicts(data){data=this.parse(data);console.log("from list of dicts",data);let headers=[];for(let row of data){for(let key in row){if(!headers.includes(key)){headers.push(key)}}}return[headers,data]}fromListOfLists(data){data=this.parse(data);console.log("from list of lists",data);let headers=new Array(data[0].length).fill(null).map((x,i)=>`#<${i}>`);return[headers,data]}}window.lz=LZString?LZString.compressToEncodedURIComponent:()=>{console.error('LZString not found. add <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"><\/script> to your html');return""};class OutputParser{constructor(tbdb){this.tbdb=tbdb;this.getColumn=this.getColumn.bind(this)}getColumn(which){for(let[i,h]of this.headers.entries()){if(h===which){return this.rows.map(row=>row[i])}}for(let[i,h]of this.headers.entries()){if(h===i){return this.tbdb.rows.map(row=>row[i])}}}get headers(){return this.tbdb.headers}get data(){return this.tbdb.data}get rows(){return this.tbdb.rows}get columnData(){let d={};for(let[i,h]of this.headers.entries()){d[h]=this.rows.map(row=>row[i])}return d}get json(){return JSON.stringify(this.data)}get lzdata(){return LZString.compressToEncodedURIComponent(JSON.stringify(this.data))}get b64data(){return btoa(JSON.stringify(this.data))}get url(){let u=new URL(window.location.href);u.search=new URLSearchParams({data:this.lzdata}).toString();return u.toString()}get csv(){let r;let csv="";let rows=[this.headers,...this.rows];for(let row of rows){r=row.map(x=>x.includes(",")?`"${x}"`:x);csv+=r.join(",")+"\n"}return csv}get lzcsv(){return LZString.compressToEncodedURIComponent(this.csv)}get b64csv(){return btoa(this.csv)}get md(){let r;let md="";let rows=[this.headers,...this.rows];for(let row of rows){r=row.map(x=>x.includes("|")?x.replace(/\|/g,"\\|"):x);md+="|"+r.join("|")+"|\n"}return md}get lzmd(){return LZString.compressToEncodedURIComponent(this.md)}get b64md(){return btoa(this.md)}}document.addEventListener("DOMContentLoaded",function(){let css=`
    
.hidden{display:none}.numPages,.page,.pageSize{width:3em}.arrows{float:right}.pagination{display:none;width:100%}teeby-deeby{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0;td,th,tr{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0}table{background-color:#aaa;border-radius:5px}td,th,tr{margin:1px}td,th{border:1px solid gray;border-radius:3px;padding:8px;text-align:left}tr:nth-child(2n){background-color:#f2f2f2}tr:nth-child(odd){background-color:#fff}th{background-color:#555;color:#fff;padding-right:20px;position:relative}th:after,th:before{border:5px solid transparent;font-size:.5em;opacity:.1;position:absolute;right:5px;top:50%}th:after{content:"▲";transform:translateY(-70%) scaleX(125%)}th:before{content:"▼";transform:translateY(-10%) scaleX(125%)}th.down:before,th.up:after{opacity:.8}th.none:hover:after,th.none:hover:before{opacity:.3}th.down:hover:after,th.up:hover:before{opacity:.5}tbody:hover{tr{filter:brightness(95%)}tr:hover{filter:brightness(110%)}}thead:hover{th{filter:brightness(95%)}th:hover{filter:brightness(110%)}tbody{brightness:95%}}td:hover{filter:brightness(120%)}tfoot{td{border:none;font-size:.75em;padding:6px}}tfoot{display:none}}teeby-deeby.pager{.pagination{display:block}}teeby-deeby.footer{tfoot{display:table-row-group}}teeby-deeby.wide{table{width:100%}}teeby-deeby.w80{table{width:80%}}teeby-deeby.third{table{width:33.3%}}teeby-deeby.quarter{table{width:25%}}teeby-deeby.scroll{table{table-layout:fixed}table,tbody{display:block}tbody{max-height:88vh;overflow-y:scroll}}teeby-deeby.h50{tbody{max-height:50vh}}teeby-deeby.p16{td,th{padding:16px}}teeby-deeby.p12{td,th{padding:12px}}teeby-deeby.p8{td,th{padding:8px}}teeby-deeby.p4{td,th{padding:4px}}teeby-deeby.p2{td,th{padding:2px}}teeby-deeby.round{table{border-radius:5px}td,th{border-radius:3px}}teeby-deeby.soft{table{border-radius:3px}td,th{border-radius:2px}}teeby-deeby.square{table,td,th{border-radius:0}}teeby-deeby.zero{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0;table,td,th,thead,tr{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0}td,th{border:0}}teeby-deeby.nogap{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0;table,td,th,thead,tr{-webkit-border-horizontal-spacing:0;-webkit-border-vertical-spacing:0}}teeby-deeby.gap1{-webkit-border-horizontal-spacing:1px;-webkit-border-vertical-spacing:1px;table,td,th,thead,tr{-webkit-border-horizontal-spacing:1px;-webkit-border-vertical-spacing:1px}}teeby-deeby.gap2{-webkit-border-horizontal-spacing:2px;-webkit-border-vertical-spacing:2px;table,td,th,thead,tr{-webkit-border-horizontal-spacing:2px;-webkit-border-vertical-spacing:2px}}@media (prefers-color-scheme:dark){table{background-color:#000}th{background-color:#212121}tr{background-color:#616161;color:#fff}tr:nth-child(2n){background-color:#424242}}teeby-deeby.dark{table{background-color:#000}th{background-color:#212121}tr{background-color:#616161;color:#fff}tr:nth-child(2n){background-color:#424242}}teeby-deeby.yellow{table{background-color:#b8860b}th{background-color:#ffeb3b}}teeby-deeby.green{table{background-color:#006400}th{background-color:#4caf50}}teeby-deeby.blue{table{background-color:#00008b}th{background-color:#2196ff}}teeby-deeby.purple{table{background-color:darkpurple}th{background-color:#9c27b0}}teeby-deeby.red{table{background-color:darkred}th{background-color:#f44336}}teeby-deeby.orange{table{background-color:#ff8c00}th{background-color:#ff9800}}teeby-deeby.rainbow{th{background-color:#000}tr{color:#fff}tr:nth-child(7n+1){background-color:red}tr:nth-child(7n+2){background-color:orange;color:#000}tr:nth-child(7n+3){background-color:#ff0;color:#000}tr:nth-child(7n+4){background-color:green}tr:nth-child(7n+5){background-color:blue}tr:nth-child(7n+6){background-color:indigo}tr:nth-child(7n+7){background-color:violet}}teeby-deeby.dblue{table{background-color:#000}th{background-color:#003}tr{background-color:#616161;color:#fff}tr:nth-child(2n){background-color:#424242}td{color:#fff}}teeby-deeby.dgreen{table{background-color:#000}th{background-color:#030}tr{background-color:#616161;color:#fff}tr:nth-child(2n){background-color:#424242}td{color:#fff}}\\n\/*# sourceMappingURL=data:application\/json;base64,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LEdBQ0ksd0JBQ0osQ0FDSixDQUNBLG1CQUNJLE1BQ0ksMkJBQ0osQ0FDQSxHQUNJLHdCQUNKLENBQ0osQ0FDQSxnQkFDSSxNQUNJLHdCQUNKLENBQ0EsR0FDSSx3QkFDSixDQUNKLENBQ0EsbUJBQ0ksTUFDSSx3QkFDSixDQUNBLEdBQ0ksd0JBQ0osQ0FDSixDQUNBLG9CQUVJLEdBQ0kscUJBQ0osQ0FDQSxHQUNJLFVBQ0osQ0FDQSxtQkFDSSxvQkFDSixDQUNBLG1CQUNJLHVCQUF3QixDQUN4QixVQUNKLENBQ0EsbUJBQ0kscUJBQXdCLENBQ3hCLFVBQ0osQ0FDQSxtQkFDSSxzQkFDSixDQUNBLG1CQUNJLHFCQUNKLENBQ0EsbUJBQ0ksdUJBQ0osQ0FDQSxtQkFDSSx1QkFDSixDQUVKLENBRUEsa0JBQ0ksTUFDSSxxQkFDSixDQUNBLEdBQ0kscUJBQ0osQ0FDQSxHQUNJLHdCQUF5QixDQUN6QixVQUNKLENBQ0EsaUJBQ0ksd0JBQ0osQ0FDQSxHQUNJLFVBQ0osQ0FDSixDQUNBLG1CQUNJLE1BQ0kscUJBQ0osQ0FDQSxHQUNJLHFCQUNKLENBQ0EsR0FDSSx3QkFBeUIsQ0FDekIsVUFDSixDQUNBLGlCQUNJLHdCQUNKLENBQ0EsR0FDSSxVQUNKLENBQ0oiLCJmaWxlIjoidGVlYnlkZWVieS5taW4uY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmhpZGRlbiB7XHJcbiAgICBkaXNwbGF5OiBub25lO1xyXG59XHJcbi5wYWdlLCAucGFnZVNpemUsIC5udW1QYWdlcyB7XHJcbiAgICB3aWR0aDogM2VtO1xyXG59XHJcbi5hcnJvd3Mge1xyXG4gICAgZmxvYXQ6IHJpZ2h0O1xyXG59XHJcbi5wYWdpbmF0aW9uIHtcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgZGlzcGxheTogbm9uZTtcclxufVxyXG5cclxuXHJcbnRlZWJ5LWRlZWJ5IHtcclxuICAgIC13ZWJraXQtYm9yZGVyLWhvcml6b250YWwtc3BhY2luZzogMHB4O1xyXG4gICAgLXdlYmtpdC1ib3JkZXItdmVydGljYWwtc3BhY2luZzogMHB4O1xyXG4gICAgdHIsIHRoLCB0ZCB7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItaG9yaXpvbnRhbC1zcGFjaW5nOiAwcHg7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItdmVydGljYWwtc3BhY2luZzogMHB4O1xyXG4gICAgfVxyXG5cclxuICAgIHRhYmxlIHtcclxuICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2FhYTtcclxuICAgIH1cclxuXHJcbiAgICB0ciwgdGgsIHRkIHtcclxuICAgICAgICBtYXJnaW46IDFweDtcclxuICAgIH1cclxuXHJcbiAgICB0aCwgdGQge1xyXG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIGdyYXk7XHJcbiAgICAgICAgcGFkZGluZzogOHB4O1xyXG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4O1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKGV2ZW4pIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjJmMmYyO1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKG9kZCkge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG4gICAgfVxyXG4gICAgdHI6aG92ZXIge1xyXG5cclxuICAgIH1cclxuICAgIHRoIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTU1O1xyXG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuICAgIHRoIHtcclxuICAgICAgcG9zaXRpb246IHJlbGF0aXZlOyAvKiBFbnN1cmVzIHRoYXQgdGhlIHBzZXVkby1lbGVtZW50cyBhcmUgcG9zaXRpb25lZCByZWxhdGl2ZSB0byB0aGUgdGggKi9cclxuICAgICAgcGFkZGluZy1yaWdodDogMjBweDsgLyogUHJvdmlkZXMgc3BhY2UgZm9yIHRoZSBhcnJvd3MgKi9cclxuICAgIH1cclxuXHJcbiAgICB0aDo6YWZ0ZXIsXHJcbiAgICB0aDo6YmVmb3JlIHtcclxuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICByaWdodDogNXB4OyAvKiBQb3NpdGlvbiBhcnJvd3MgdG93YXJkcyB0aGUgcmlnaHQgKi9cclxuICAgICAgdG9wOiA1MCU7IC8qIENlbnRlciB2ZXJ0aWNhbGx5ICovXHJcbiAgICAgIGJvcmRlcjogNXB4IHNvbGlkIHRyYW5zcGFyZW50OyAvKiBDcmVhdGUgYXJyb3cgc2hhcGUgKi9cclxuICAgICAgZm9udC1zaXplOiAwLjVlbTtcclxuICAgICAgb3BhY2l0eTogMC4xO1xyXG4gICAgfVxyXG4gICAgdGg6OmFmdGVyIHtcclxuICAgICAgY29udGVudDogJ+KWsic7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNzAlKSBzY2FsZVgoMTI1JSk7XHJcbiAgICB9XHJcbiAgICB0aDo6YmVmb3JlIHtcclxuICAgICAgY29udGVudDogJ+KWvCc7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTAlKSBzY2FsZVgoMTI1JSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGgudXA6OmFmdGVyIHtcclxuICAgICAgICBvcGFjaXR5OiAwLjg7XHJcbiAgICB9XHJcbiAgICB0aC5kb3duOjpiZWZvcmUge1xyXG4gICAgICAgIG9wYWNpdHk6IDAuODtcclxuICAgIH1cclxuXHJcbiAgICB0aC5ub25lOmhvdmVyOjpiZWZvcmUsXHJcbiAgICB0aC5ub25lOmhvdmVyOjphZnRlciB7XHJcbiAgICAgICAgb3BhY2l0eTogMC4zO1xyXG4gICAgfVxyXG4gICAgdGgudXA6aG92ZXI6OmJlZm9yZSB7XHJcbiAgICAgICAgb3BhY2l0eTogMC41O1xyXG4gICAgfVxyXG4gICAgdGguZG93bjpob3Zlcjo6YWZ0ZXIge1xyXG4gICAgICAgIG9wYWNpdHk6IDAuNTtcclxuICAgIH1cclxuXHJcbiAgICB0Ym9keTpob3ZlciB7XHJcbiAgICAgICAgdHIge1xyXG4gICAgICAgICAgICBmaWx0ZXI6IGJyaWdodG5lc3MoOTUlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHI6aG92ZXIge1xyXG4gICAgICAgICAgICBmaWx0ZXI6IGJyaWdodG5lc3MoMTEwJSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhlYWQ6aG92ZXIge1xyXG4gICAgICAgIHRoIHtcclxuICAgICAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDk1JSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoOmhvdmVyIHtcclxuICAgICAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDExMCUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0Ym9keSB7XHJcbiAgICAgICAgICAgIGJyaWdodG5lc3M6IDk1JTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0ZDpob3ZlciB7XHJcbiAgICAgICAgZmlsdGVyOiBicmlnaHRuZXNzKDEyMCUpO1xyXG4gICAgfVxyXG5cclxuICAgIHRmb290IHtcclxuICAgICAgICB0ZCB7XHJcbiAgICAgICAgICAgIHBhZGRpbmc6IDZweDtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAwLjc1ZW07XHJcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGZvb3Qge1xyXG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxudGVlYnktZGVlYnkucGFnZXIge1xyXG4gICAgLnBhZ2luYXRpb24ge1xyXG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxudGVlYnktZGVlYnkuZm9vdGVyIHtcclxuICAgIHRmb290IHtcclxuICAgICAgICBkaXNwbGF5OiB0YWJsZS1yb3ctZ3JvdXA7XHJcbiAgICB9XHJcbn1cclxuXHJcbnRlZWJ5LWRlZWJ5LndpZGUge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgfVxyXG59XHJcblxyXG50ZWVieS1kZWVieS53ODAge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIHdpZHRoOiA4MCU7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkudGhpcmQge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIHdpZHRoOiAzMy4zJTtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5xdWFydGVyIHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICB3aWR0aDogMjUlO1xyXG4gICAgfVxyXG59XHJcblxyXG50ZWVieS1kZWVieS5zY3JvbGwge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7XHJcbiAgICB9XHJcbiAgICB0YWJsZSwgdGJvZHkge1xyXG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgfVxyXG4gICAgdGJvZHkge1xyXG4gICAgICAgIG1heC1oZWlnaHQ6IDg4dmg7XHJcbiAgICAgICAgb3ZlcmZsb3cteTogc2Nyb2xsO1xyXG4gICAgfVxyXG59XHJcblxyXG50ZWVieS1kZWVieS5oNTAge1xyXG4gICAgdGJvZHkge1xyXG4gICAgICAgIG1heC1oZWlnaHQ6IDUwdmg7XHJcbiAgICB9XHJcbn1cclxuXHJcbnRlZWJ5LWRlZWJ5LnAxNiB7XHJcbiAgICB0aCwgdGQge1xyXG4gICAgICAgIHBhZGRpbmc6IDE2cHg7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkucDEyIHtcclxuICAgIHRoLCB0ZCB7XHJcbiAgICAgICAgcGFkZGluZzogMTJweDtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5wOCB7XHJcbiAgICB0aCwgdGQge1xyXG4gICAgICAgIHBhZGRpbmc6IDhweDtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5wNCB7XHJcbiAgICB0aCwgdGQge1xyXG4gICAgICAgIHBhZGRpbmc6IDRweDtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5wMiB7XHJcbiAgICB0aCwgdGQge1xyXG4gICAgICAgIHBhZGRpbmc6IDJweDtcclxuICAgIH1cclxufVxyXG5cclxudGVlYnktZGVlYnkucm91bmQge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIH1cclxuICAgIHRoLCB0ZCB7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4O1xyXG4gICAgfVxyXG59XHJcbnRlZWJ5LWRlZWJ5LnNvZnQge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDtcclxuICAgIH1cclxuICAgIHRoLCB0ZCB7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4O1xyXG4gICAgfVxyXG59XHJcbnRlZWJ5LWRlZWJ5LnNxdWFyZSB7XHJcbiAgICB0YWJsZSwgdGgsIHRkIHtcclxuICAgICAgICBib3JkZXItcmFkaXVzOiAwO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxudGVlYnktZGVlYnkuemVybyB7XHJcbiAgICAtd2Via2l0LWJvcmRlci1ob3Jpem9udGFsLXNwYWNpbmc6IDBweDtcclxuICAgIC13ZWJraXQtYm9yZGVyLXZlcnRpY2FsLXNwYWNpbmc6IDBweDtcclxuICAgIHRhYmxlLCB0aGVhZCwgdHIsIHRoLCB0ZCB7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItaG9yaXpvbnRhbC1zcGFjaW5nOiAwcHg7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItdmVydGljYWwtc3BhY2luZzogMHB4O1xyXG4gICAgfVxyXG4gICAgdGgsIHRkIHtcclxuICAgICAgICBib3JkZXI6IDA7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkubm9nYXAge1xyXG4gICAgLXdlYmtpdC1ib3JkZXItaG9yaXpvbnRhbC1zcGFjaW5nOiAwcHg7XHJcbiAgICAtd2Via2l0LWJvcmRlci12ZXJ0aWNhbC1zcGFjaW5nOiAwcHg7XHJcbiAgICB0YWJsZSwgdGhlYWQsIHRyLCB0aCwgdGQge1xyXG4gICAgICAgIC13ZWJraXQtYm9yZGVyLWhvcml6b250YWwtc3BhY2luZzogMHB4O1xyXG4gICAgICAgIC13ZWJraXQtYm9yZGVyLXZlcnRpY2FsLXNwYWNpbmc6IDBweDtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5nYXAxIHtcclxuICAgIC13ZWJraXQtYm9yZGVyLWhvcml6b250YWwtc3BhY2luZzogMXB4O1xyXG4gICAgLXdlYmtpdC1ib3JkZXItdmVydGljYWwtc3BhY2luZzogMXB4O1xyXG4gICAgdGFibGUsIHRoZWFkLCB0ciwgdGgsIHRkIHtcclxuICAgICAgICAtd2Via2l0LWJvcmRlci1ob3Jpem9udGFsLXNwYWNpbmc6IDFweDtcclxuICAgICAgICAtd2Via2l0LWJvcmRlci12ZXJ0aWNhbC1zcGFjaW5nOiAxcHg7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkuZ2FwMiB7XHJcbiAgICAtd2Via2l0LWJvcmRlci1ob3Jpem9udGFsLXNwYWNpbmc6IDJweDtcclxuICAgIC13ZWJraXQtYm9yZGVyLXZlcnRpY2FsLXNwYWNpbmc6IDJweDtcclxuICAgIHRhYmxlLCB0aGVhZCwgdHIsIHRoLCB0ZCB7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItaG9yaXpvbnRhbC1zcGFjaW5nOiAycHg7XHJcbiAgICAgICAgLXdlYmtpdC1ib3JkZXItdmVydGljYWwtc3BhY2luZzogMnB4O1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyMTIxMjE7XHJcbiAgICB9XHJcbiAgICB0ciB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzYxNjE2MTtcclxuICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICB9XHJcbiAgICB0cjpudGgtY2hpbGQoZXZlbikge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0MjQyNDI7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxudGVlYnktZGVlYnkuZGFyayB7XHJcbiAgICB0YWJsZSB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7XHJcbiAgICB9XHJcbiAgICB0aCB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzIxMjEyMTtcclxuICAgIH1cclxuICAgIHRyIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjE2MTYxO1xyXG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuICAgIHRyOm50aC1jaGlsZChldmVuKSB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzQyNDI0MjtcclxuICAgIH1cclxufVxyXG5cclxudGVlYnktZGVlYnkueWVsbG93IHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrZ29sZGVucm9kO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkVCM0I7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkuZ3JlZW4ge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGRhcmtncmVlbjtcclxuICAgIH1cclxuICAgIHRoIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNENBRjUwO1xyXG4gICAgfVxyXG59XHJcbnRlZWJ5LWRlZWJ5LmJsdWUge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGRhcmtibHVlO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyMTk2RkY7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkucHVycGxlIHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrcHVycGxlO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM5QzI3QjA7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkucmVkIHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrcmVkO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGNDQzMzY7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkub3JhbmdlIHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBkYXJrb3JhbmdlO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRjk4MDA7XHJcbiAgICB9XHJcbn1cclxudGVlYnktZGVlYnkucmFpbmJvdyB7XHJcblxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xyXG4gICAgfVxyXG4gICAgdHIge1xyXG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuICAgIHRyOm50aC1jaGlsZCg3bisxKXtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XHJcbiAgICB9XHJcbiAgICB0cjpudGgtY2hpbGQoN24rMil7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogb3JhbmdlO1xyXG4gICAgICAgIGNvbG9yOiBibGFjaztcclxuICAgIH1cclxuICAgIHRyOm50aC1jaGlsZCg3biszKXtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XHJcbiAgICAgICAgY29sb3I6IGJsYWNrO1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKDduKzQpe1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGdyZWVuO1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKDduKzUpe1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGJsdWU7XHJcbiAgICB9XHJcbiAgICB0cjpudGgtY2hpbGQoN24rNil7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogaW5kaWdvO1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKDduKzcpe1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZpb2xldDtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbnRlZWJ5LWRlZWJ5LmRibHVlIHtcclxuICAgIHRhYmxlIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjaztcclxuICAgIH1cclxuICAgIHRoIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAzO1xyXG4gICAgfVxyXG4gICAgdHIge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM2MTYxNjE7XHJcbiAgICAgICAgY29sb3I6IHdoaXRlO1xyXG4gICAgfVxyXG4gICAgdHI6bnRoLWNoaWxkKGV2ZW4pIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDI0MjQyO1xyXG4gICAgfVxyXG4gICAgdGQge1xyXG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxufVxyXG50ZWVieS1kZWVieS5kZ3JlZW4ge1xyXG4gICAgdGFibGUge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xyXG4gICAgfVxyXG4gICAgdGgge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMzA7XHJcbiAgICB9XHJcbiAgICB0ciB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzYxNjE2MTtcclxuICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICB9XHJcbiAgICB0cjpudGgtY2hpbGQoZXZlbikge1xyXG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0MjQyNDI7XHJcbiAgICB9XHJcbiAgICB0ZCB7XHJcbiAgICAgICAgY29sb3I6IHdoaXRlO1xyXG4gICAgfVxyXG59XHJcbiJdfQ== *\/\\n
    `;let head=document.head||document.getElementsByTagName("head")[0];let style=document.createElement("style");style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}head.appendChild(style)});class TeebyDeeby extends HTMLElement{constructor(){super();this._pageSize=25;this._page=0;this._headers=[];this._data=[];this.setupInnerHTML=this.setupInnerHTML.bind(this);this.onload=this.onload.bind(this);this._rowToDict=this._rowToDict.bind(this);this.addColumn=this.addColumn.bind(this);this.removeColumn=this.removeColumn.bind(this);this.moveColumn=this.moveColumn.bind(this);this.addRow=this.addRow.bind(this);this.removeRow=this.removeRow.bind(this);this.moveRow=this.moveRow.bind(this);this.parser=new InputParser;this.out=new OutputParser(this);this.sort=this.sort.bind(this);this.rePage=this.rePage.bind(this);this._onTHClick=this._onTHClick.bind(this);this._onHeaderEdit=this._onHeaderEdit.bind(this);this._onDataEdit=this._onDataEdit.bind(this);this._onDataEditInput=this._onDataEditInput.bind(this);this._onHeaderEditInput=this._onHeaderEditInput.bind(this);this._unsavedHeaderEdits={};this._unsavedDataEdits={};this.fromSRC=this.fromSRC.bind(this);this.resizeThead=this.resizeThead.bind(this);this.setContent=this.setContent.bind(this);this.resizing=0;this._contentEditable=false;this._headersEditable=false;for(let method of Object.getOwnPropertyNames(Object.getPrototypeOf(this.parser))){if(method.startsWith("from")){if(!this[method]){console.log("adding",method);this[method]=function(a,b){console.log("calling",method,a,b);let[h,d]=this.parser[method](a,b);this.setContent(h,d)}.bind(this)}}}document.addEventListener("DOMContentLoaded",this.onload)}setupInnerHTML(){this.innerHTML=`
            <table>
                <thead>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                </tfoot>
                <div class="pagination">
                    <span>Page </span>
                    <input type="number" class="page" value="0" min="0"  max="10000" >
                    <span>/</span>
                    <input type="number" class="numPages" min="0"  max="10000" value="0" disabled>

                    <span>(size</span>
                    <input type="number" class="pageSize" min="0" max="10000" value="50">
                    <span>)</span>

                    <div class="arrows hidden">
                        <button class="prev">prev</button>
                        <button class="next">next</button>
                    </div>
                </div>
            </table>

        `;this.table=this.querySelector("table");this.thead=this.querySelector("thead");this.tbody=this.querySelector("tbody");this.tfoot=this.querySelector("tfoot");this.pager=this.querySelector(".pager");this.pageInput=this.querySelector(".page");this.pageInput.value=this._page;this.numPagesInput=this.querySelector(".numPages");this.numPagesInput.value=this._numPages;this.pageSizeInput=this.querySelector(".pageSize");this.pageSizeInput.value=this._pageSize;this.pageSizeInput.addEventListener("input",e=>{this.pageSize=e.target.value});this.pageInput.addEventListener("input",e=>{this.page=e.target.value});this.prev=this.querySelector(".prev");this.next=this.querySelector(".next");if(this.prev){this.prev.addEventListener("click",e=>{this.page-=1})}if(this.next){this.next.addEventListener("click",e=>{this.page+=1})}}onload(){let url=new URL(window.location.href);let mode=this.getAttribute("mode")||url.searchParams.get("mode")||"horizontal";let uclass=url.searchParams.get("class");this._contentEditable=this.getAttribute("contenteditable")||url.searchParams.get("contenteditable")||false;this._headersEditable=this.getAttribute("headerseditable")||url.searchParams.get("headerseditable")||false;let _pageSize=this.getAttribute("pagesize")||url.searchParams.get("pagesize");this._pageSize=parseInt(this.getAttribute("pagesize")||url.searchParams.get("pagesize")||this._pageSize);if(this._pageSize instanceof String||typeof this._pageSize==="string"){this._pageSize=parseInt(this._pageSize)}let _page=this.getAttribute("page")||url.searchParams.get("page");this._page=parseInt(_page||this._page);if(this._page instanceof String||typeof this._page==="string"){this._page=parseInt(this._page)}console.warn("page",_page,this.getAttribute("page"),url.searchParams.get("page"),this.getAttribute("page")||url.searchParams.get("page"));if(_page===null&&parseInt(_pageSize)>0){this._page=1}if(this._page>0&&this._pageSize>0){this.classList.add("pager")}console.warn("contenteditable",this._contentEditable,this._headersEditable);if(uclass){for(let cls of uclass.split(" ")){this.classList.add(cls.trim())}}this.parser.defaultFromDictMode=mode;let t=this.innerHTML.trim();this.setupInnerHTML();if(t){return this.fromString(t)}let headers=this.getAttribute("headers");let data=this.getAttribute("data");let markdown=this.getAttribute("md");let csv=this.getAttribute("csv");let src=this.getAttribute("src");if(src){return this.fromSRC(src)}console.log(this,{headers:headers,data:data,markdown:markdown,csv:csv});if(!headers&&!data){if(markdown){return this.fromMarkdown(markdown)}else if(csv){return this.fromCSV(csv)}else{headers=url.searchParams.get("headers");data=url.searchParams.get("data");markdown=url.searchParams.get("md");csv=url.searchParams.get("csv");src=url.searchParams.get("src");if(src){return this.fromSRC(src)}console.log("url",{headers:headers,data:data,markdown:markdown,csv:csv});if(!headers&&!data){console.log("no headers or data");if(markdown){return this.fromMarkdown(markdown)}else if(csv){return this.fromCSV(csv)}else{console.log("displaying default");return this.fromData(["fmt","what","attribute(s)","lz okay","b64 okay"],[["json","autodetect","data","yes","yes"],["url","path to .json, .md, .csv","src","yes","yes"],["markdown","table","md","yes","yes"],["csv","table","csv","yes","yes"],["innerHTML","table","N/A","no","no"],["headers + list of lists","list","headers","yes","yes"],["list of lists","row values","data","yes","yes"],["list of dicts","row values","data","yes","yes"],["dict of dicts","row values","data","yes","yes"],["dict of lists","column values","data","yes","yes"],["dict of values","single row (if mode = 'horizontal')","data","yes","yes"],["dict of values","key/value columns (if mode = 'vertical')","data","yes","yes"]])}}return this.fromData(headers,data)}}return this.fromData(headers,data)}get minRow(){return this.page?(this._page-1)*this._pageSize:0}get maxRow(){return this.page?this._page*this._pageSize:this._data.length}get pageSize(){return this._pageSize}get page(){return this._page}get numPages(){return Math.ceil(this._data.length/this._pageSize)}set page(value){value=parseInt(value);this._page=value;this.pageInput.value=value;this.rePage()}set pageSize(value){value=parseInt(value);this._pageSize=value;this.pageSizeInput.value=value;this.numPagesInput.value=this.numPages;this.rePage()}_onTHClick(e){console.log("th click",e);let th=e.target;let colInd=Array.from(th.parentElement.children).indexOf(th);console.log("colInd",colInd);if(th.classList.contains("up")){this.sort(colInd,0)}else if(th.classList.contains("down")){this.sort(colInd,1)}else{this.sort(colInd,-1)}}sort(colInd,dir=1){if(typeof colInd==="string"){colInd=this._headers.indexOf(colInd)}else if(colInd<0){colInd=this._headers.length+colInd}if(dir==="up"){dir=1}if(dir==="down"){dir=-1}if(dir==="none"||!dir){dir=0}let th=this.thead.children[colInd];let oldDir=parseInt(th.getAttribute("dir")||"0");console.log(th,oldDir,dir);if(oldDir===dir){return}th.classList.remove("down");th.classList.remove("up");th.classList.remove("none");if(dir===0){th.classList.add("none")}else if(dir===1){th.classList.add("up")}else if(dir===-1){th.classList.add("down")}else{throw new Error("dir must be 1, 0, or -1")}th.setAttribute("dir",dir);let column=this._data.map((row,i)=>{return{value:row[colInd],index:i}});if(column.every(x=>!isNaN(x.value))){column=column.map(x=>{return{value:parseFloat(x.value),index:x.index}})}let sortFunc=(a,b)=>{let av=a.value;let bv=b.value;if(av<bv){return dir}if(av>bv){return-dir}return 0};column.sort(sortFunc);let oldRows=Array.from(this.tbody.children);let newData=[];this.tbody.innerHTML="";for(let row of column){newData.push(this._data[row.index]);this.tbody.appendChild(oldRows[row.index])}this._data=newData}_onDataEditInput(rowInd,colInd,value){console.log("data edit input",rowInd,colInd,value);if(!this._unsavedDataEdits[rowInd]){this._unsavedDataEdits[rowInd]={}}this._unsavedDataEdits[rowInd][colInd]=value;if(this.onDataEditInput){this.onDataEditInput(rowInd,colInd,value)}if(this.addedResize){this.resizeThead()}}_onDataEdit(rowInd,colInd,value){if(this._unsavedDataEdits[rowInd]&&this._unsavedDataEdits[rowInd][colInd]){delete this._unsavedDataEdits[rowInd][colInd];if(Object.keys(this._unsavedDataEdits[rowInd]).length===0){delete this._unsavedDataEdits[rowInd]}}if(value===this._data[rowInd][colInd]){return}console.log("data edit",rowInd,colInd,value);this._data[rowInd][colInd]=value;if(this.onDataEdit){this.onDataEdit(rowInd,colInd,value)}}_onHeaderEditInput(colInd,value){console.log("header edit input",colInd,value);this._unsavedHeaderEdits[colInd]=value;if(this.onHeaderEditInput){this.onHeaderEditInput(colInd,value)}if(this.addedResize){this.resizeThead()}}_onHeaderEdit(colInd,value){delete this._unsavedHeaderEdits[colInd];if(value===this._headers[colInd]){return}console.log("header edit",colInd,value);this._headers[colInd]=value;if(this.onHeaderEdit){this.onHeaderEdit(colInd,value)}}fromSRC(src){this.parser.fromSRC(src).then(([h,d])=>this.setContent(h,d))}addColumn(headerKey=null,index=-1,fillValue=undefined){console.log("adding column contenteditable",this._contentEditable);if(index<0){index=this._headers.length+index+1}if(headerKey===null){headerKey=`#<${index}>`}this._headers.splice(index,0,headerKey);let th=document.createElement("th");th.innerHTML=headerKey;th.classList.add("none");if(this._headersEditable){th.setAttribute("contenteditable",true);th.addEventListener("input",e=>{this._onHeaderEditInput(th.cellIndex,e.target.innerHTML)});th.addEventListener("blur",e=>{this._onHeaderEdit(th.cellIndex,e.target.innerHTML)})}th.addEventListener("click",this._onTHClick);if(index===this._headers.length-1){this.thead.appendChild(th)}else{this.thead.insertBefore(th,this.thead.children[index])}let tf=document.createElement("td");tf.innerHTML="";if(index===this._headers.length-1){this.tfoot.appendChild(tf)}else{this.tfoot.insertBefore(tf,this.tfoot.children[index])}this._headers=this._headers.map((x,i)=>{if(x.startsWith("#<")&&x.endsWith(">")){return`#<${i}>`}return x});for(let data of this._data){let isfunc=typeof fillValue==="function";if(isfunc){data.splice(index,0,null);fillValue=fillValue(this._rowToDict(data));data[index]=fillValue}else{data.splice(index,0,fillValue)}}for(let row of this.tbody.children){if(i==0){continue}let cell=row.insertCell(index);if(this._contentEditable){cell.setAttribute("contenteditable",true);cell.addEventListener("input",e=>{this._onDataEditInput(row.rowIndex,cell.cellIndex,e.target.innerHTML)});cell.addEventListener("blur",e=>{this._onDataEdit(row.rowIndex,cell.cellIndex,e.target.innerHTML)})}cell.innerHTML=fillValue}}removeColumn(index){if(index<0){index=this._headers.length+index}this._headers.splice(index,1);for(let data of this._data){data.splice(index,1)}for(let row of this.tbody.children){row.deleteCell(index)}}moveColumn(startIndex,endIndex){if(startIndex<0){startIndex=this._headers.length+startIndex}if(endIndex<0){endIndex=this._headers.length+endIndex}let header=this._headers.splice(startIndex,1)[0];this._headers.splice(endIndex,0,header);for(let data of this._data){let value=data.splice(startIndex,1)[0];data.splice(endIndex,0,value)}for(let row of this.tbody.children){let cell=row.deleteCell(startIndex);row.insertBefore(cell,row.children[endIndex])}}_rowToDict(row){let dict={};for(let i=0;i<this._headers.length;i++){dict[this._headers[i]]=row[i]}return dict}addRow(data=undefined){if(data===undefined){data=new Array(this._headers.length).fill(null)}else if(data instanceof Array){}else if(data instanceof Object){data=this._headers.map(h=>data[h])}this._data.push(data);let row=this.tbody.insertRow(-1);for(let value of data){let cell=row.insertCell(-1);if(this._contentEditable){cell.setAttribute("contenteditable",true);cell.addEventListener("input",e=>{this._onDataEditInput(row.rowIndex,cell.cellIndex,e.target.innerHTML)});cell.addEventListener("blur",e=>{this._onDataEdit(row.rowIndex,cell.cellIndex,e.target.innerHTML)})}cell.innerHTML=value}let rowInd=this._data.length-1;if(this.minRow<=rowInd&&rowInd<this.maxRow){row.classList.remove("hidden")}else{row.classList.add("hidden")}this.numPagesInput.value=this.numPages}removeRow(index){this._data.splice(index,1);this.tbody.deleteRow(index);if(index<0){index=this._data.length+index}let nextRow=this.tbody.children[index];if(nextRow){if(this.minRow<=index&&index<this.maxRow){nextRow.classList.remove("hidden")}else{nextRow.classList.add("hidden")}}}moveRow(startIndex,endIndex){let data=this._data.splice(startIndex,1)[0];this._data.splice(endIndex,0,data);let row=this.tbody.deleteRow(startIndex);this.tbody.insertBefore(row,this.tbody.children[endIndex]);this.rePage()}rePage(){if(this._page>0&&this._pageSize>0){this.classList.add("pager")}for(let i=0;i<this._data.length;i++){let row=this.tbody.children[i];if(this.minRow<=i&&i<this.maxRow){row.classList.remove("hidden")}else{row.classList.add("hidden")}}if(this.addedResize){this.resizeThead()}}setContent(headers,data){for(let h of headers){this.addColumn(h)}for(let d of data){this.addRow(d)}if(this.table.offsetHeight>window.innerHeight){this.classList.add("scroll")}console.log("set content",this.classList,this.classList.contains("scroll"));if(this.classList.contains("scroll")){this.resizeThead()}}resizeThead(){this.resizing+=1;let r=this.resizing;const firstRowCells=Array.from(this.tbody.children[0].children);const headerCells=Array.from(this.thead.children);const tbodyWidth=this.tbody.children[0].offsetWidth;const theadWidth=this.table.offsetWidth;const scrollbarWidth=(theadWidth-tbodyWidth)/2;console.warn("resize",tbodyWidth,theadWidth);console.log("resizing",firstRowCells,headerCells);for(let i=0;i<20;i++){if(this.resizing!==r){return}firstRowCells.map((cell,index)=>{if(headerCells[index]!==undefined){const cellWidth=cell.offsetWidth;if(index===firstRowCells.length-1){headerCells[index].style.width=`${cellWidth+scrollbarWidth}px`}else{headerCells[index].style.width=`${cellWidth}px`}}});headerCells.map((cell,index)=>{if(firstRowCells[index]!==undefined){const cellWidth=cell.offsetWidth;if(index===firstRowCells.length-1){firstRowCells[index].style.width=`${cellWidth-scrollbarWidth}px`}else{firstRowCells[index].style.width=`${cellWidth}px`}}})}if(!this.addedResize){window.addEventListener("resize",this.resizeThead.bind(this));this.addedResize=true}}get headers(){return this._headers}get rows(){return this._data}get data(){return this._data.map(this._rowToDict)}}customElements.define("teeby-deeby",TeebyDeeby);